
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Preprocessor Directives</title> 
<meta name="author" content="Stratify Labs, Inc">

<!-- Enable responsive viewport -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
<!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

<!-- Le styles -->
<link href="/assets/themes/twitter}/bootstrap3/css/bootstrap.min.css" rel="stylesheet">
<script src="/assets/themes/twitter}/bootstrap3/js/jquery-2.0.3.min.js"></script>
<script src="/assets/themes/twitter}/bootstrap3/js/bootstrap.min.js"></script>
<link href="/assets/themes/twitter}/bootstrap3/css/font-awesome.min.css" rel="stylesheet">
<link href="/assets/themes/twitter}/css/style.css" rel="stylesheet">
<link href="/assets/themes/twitter}/css/syntax.css" rel="stylesheet">
<script src="/assets/themes/twitter}/js/application.js"></script>

<!-- Le fav and touch icons -->
<!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

<!-- atom & rss feed -->
<link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
<link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

</head>
<body style="min-height: 200px; padding-top: 50px;">
	<header class="navbar navbar-default navbar-fixed-top bs-docs-nav" role="banner">
		<div class="container">
			<div class="row">
				<div class="col-md-12">
					<div class="navbar-header">
						<button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".menu-navbar-collapse">
							<span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span>
						</button>
						<a class="navbar-brand" href="/index.html">
							<img style="height: 22px;" src="/images/Stratify-Labs-Logo.svg" />
						</a>
					</div>

					<!-- Collect the nav links, forms, and other content for toggling -->
					<div class="collapse navbar-collapse menu-navbar-collapse" role="navigation">
						<ul class="nav navbar-nav">
							<li><a href="https://github.com/StratifyLabs"><i class="fa fa-code-fork"></i> Code</a></li>
							<li><a href="/tips.html"><i class="fa fa-exclamation-circle"></i> Design Tips</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</header>

	<a class="anchor" id="top"></a>


	<div class="content" id="content">
		


<div class="container">
	<div class="row" style="margin-top: 20px;">
		<div class="col-md-8">
					<h1>
						Preprocessor Directives <small>Embedded C Tutorial</small>
					</h1>
					<p>The C language preprocesses all code before compilation. Within the program, preprocessor directives give special instructions to the preprocessor. Preprocessor directives in C start with the hash symbol (#). This tutorial describes the basic function of preprocessor directives in C. The following directives are available:</p>

<ul>
  <li>#include: include another file in the source</li>
  <li>#define: define a symbol to be replaced during preprocessing</li>
  <li>#undef: un-define a previously defined symbol</li>
  <li>#if, #ifdef, #ifndef, #else, #endif: tell the preprocessor to conditionally compile parts of the code</li>
  <li>#pragma: give a special instruction to the compiler</li>
  <li>#error: specify a user-defined error</li>
  <li>#warning: specifiy a user-define warning</li>
  <li>#include</li>
</ul>

<p>When the preprocessor encounters the #include directive, it replaces the #include line with the contents of the included file. Local files are included using quotation marks while system files are included using less/greater than symbols.</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#include &lt;stdlib.h&gt;//This is a system file 
#include "local.h" //This is a local include file </span></code></pre></figure>

<h3 id="define-and-undef">#define and #undef</h3>

<p>When the preprocessor encounters the #define directive, it replaces the symbol with the specified definition. As a matter of convention, defined symbols are written in all capital letters using underscores to separate words. The #undef directive can be used to remove the definition of a previous #define. The following program shows the basic usage of #define.</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#define INIT_X_VALUE 10 
#define INIT_Y_VALUE 100 
</span><span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">argv</span><span class="p">[]){</span> 
     <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span> 
     <span class="n">x</span> <span class="o">=</span> <span class="n">INIT_X_VALUE</span><span class="p">;</span> 
     <span class="n">y</span> <span class="o">=</span> <span class="n">INIT_Y_VALUE</span><span class="p">;</span> 
     <span class="n">printf</span><span class="p">(</span><span class="s">"X is %d, Y is %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span> 
     <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<h3 id="if-ifdef-ifndef-else-endif">#if, #ifdef, #ifndef, #else, #endif</h3>

<p>The conditional directives tell the compiler to omit or include certain code snippets based on various criteria. Let’s start with a program example.</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#define DEBUG 1
#ifdef DEBUG
#define debug_printf(...) printf(__VA_ARGS) 
#else 
#define debug_printf(...) 
#endif 
</span><span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">argv</span><span class="p">[]){</span> 
     <span class="n">debug_printf</span><span class="p">(</span><span class="s">"This is a debug message</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span> 
     <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> 
<span class="p">}</span></code></pre></figure>

<p>The preceding program illustrates one way to enable and disable debugging messages in a program. It uses the #ifdef directive to tell the compiler to use printf() if DEBUG is defined and just use an empty statement if it is not.</p>

<p>One standard use of the #ifndef directive is called a header guard. If a single program includes the same header more than once, this can sometimes cause problems because some types may be defined more than one time. A header guard prevents these problems by defining a new symbol and only including the header if the new symbol has not yet been defined. This ensures the preprocessor only includes the file one time.</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#ifndef MY_HEADER_FILE_H_
#define MY_HEADER_FILE_H_
</span><span class="k">typedef</span> <span class="kt">int</span> <span class="n">my_int_type</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">my_function_prototype</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="cp">#endif //end if for MY_HEADER_FILE_H_</span></code></pre></figure>

<h3 id="error-and-warning">#error and #warning</h3>

<p>The #error and #warning directives allow for user defined errors and warnings that the compiler picks uThe utility of these directives is in making sure the program is configured correctly if there are limits on what conditions the program may compile. The following program illustrates how these directives may be used.</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#define DEBUG 1 
#if DEBUG != 0 
#define debug_printf(...) printf(__VA_ARGS) 
#warning "Debugging is turned on" 
#else #define debug_printf(...) 
#endif 
</span><span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">argv</span><span class="p">[]){</span> 
     <span class="n">debug_printf</span><span class="p">(</span><span class="s">"This is a debug message</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span> 
     <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> 
<span class="p">}</span></code></pre></figure>

<p>The program above uses a preprocessor directive that causes the compiler to warn the user if debugging is enabled. In other situations, #error might be more appropriate. For example, if the user has defined a value that is not in a valid range.</p>

<h3 id="pragma">#pragma</h3>

<p>The #pragma directive gives special instructions to the compiler. The #pragma directive is especially useful in embedded C programming and can tell the compiler to allocate a certain variable in RAM or EEPROM. It can also tell the compiler to insert a snippet of assembly language code.</p>

<p>The GNU GCC compiler, which is a popular compiler for various embedded architectures such as ARM and AVR, also uses attributes as an alternative syntax to the #pragma directive.</p>

<h3 id="take-away">Take Away</h3>

<p>C language compilers always preprocess the code and execute any preprocessor directives during that stage. The most commonly used preprocessor directives (especially among beginners) are #include and #define. #include is simple to use; you just need to remember quotes for local files and less/greater than symbols for system files. #define is handy for code maintenance. If a value is fixed, it should be defined as a macro so that if it needs to be changed, it only needs to be changed in one location. Lastly, if you create your own header file, it is imperative that you use a header guard of the form: #ifndef NAME_H_, #define NAME_H_, … #endif.</p>



			
			<ul class="nav nav-pills">
				
				


  
     
    	<li><a href="/tags.html#embedded-ref">embedded <span class="badge">11</span></a></li>
     
    	<li><a href="/tags.html#tutorial-ref">tutorial <span class="badge">10</span></a></li>
    
  



			</ul>
			
			<div class="pagination">
				<center>
					 
						<a href="/embedded%20c%20tutorial/2013/12/07/Embedded-C-Tutorial-Pointers-and-Arrays" type="button" class="btn btn-primary"
							data-toggle="tooltip" data-placement="left" title="" data-original-title="Previous Post"
							>
							<i class="fa fa-arrow-left"></i>
						</a> 
					 
					<a href="/archive.html" type="button" class="btn btn-primary"
						data-toggle="tooltip" data-placement="top" title="" data-original-title="Archives"
						>
						<i class="fa fa-archive"></i>
					</a> 
					<a href="/categories.html" type="button" class="btn btn-primary"
						data-toggle="tooltip" data-placement="top" title="" data-original-title="Categories"
					>
						<i class="fa fa-folder-open"></i>
					</a> 
					 
						<a href="/embedded%20c%20tutorial/2013/12/09/Embedded-C-Tutorial-Compound-Data-Types" type="button" class="btn btn-primary"
							data-toggle="tooltip" data-placement="right" title="" data-original-title="Next Post"
							>
							<i class="fa fa-arrow-right"></i>
						</a>
					
				</center>
			</div>
				
		</div>
		<div class="col-md-4">
		

			<h3>Embedded C Tutorial</h3>
			<ul class="nav nav-pills nav-stacked">
				
				
				


  



			</ul>

			
			
			  
		</div>
	</div>

</div>



	</div>

	<footer style="background: #344555; color: #fff;">
		<div class="container">
			<div class="row" style="margin-top: 20px; margin-bottom: 20px; ">
				<div class="col-md-12">
					<p>&copy; 2016 Stratify Labs, Inc</p>
				</div>
			</div>
		</div>
	</footer>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-75152879-1', 'stratifylabs.co');
  ga('send', 'pageview');

</script>
 </body>
</html>

